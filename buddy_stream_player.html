<html><head><base href="https://freestream.io/">
  <title>Free Live TV No Bullshit</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #121212;
      color: #e0e0e0;
    }

    header {
      background-color: #1e1e1e;
      color: white;
      padding: 1em;
      text-align: center;
    }

    h1 {
      margin: 0;
    }

    .container {
      display: flex;
      max-width: 1400px;
      margin: 2em auto;
      padding: 0 2em;
      gap: 2em;
    }

    .channel-list {
      width: 300px;
      height: calc(100vh - 200px);
      background-color: #1e1e1e;
      overflow-y: auto;
    }

    .channel-item {
      padding: 1em;
      border-bottom: 1px solid #333;
      cursor: pointer;
    }

    .channel-item:hover {
      background-color: #2e2e2e;
    }

    .channel-item.active {
      background-color: #3e3e3e;
    }

    .player-container {
      flex-grow: 1;
    }

    #videoPlayer {
      width: 100%;
      aspect-ratio: 16 / 9;
    }
  </style>
  <link href="https://vjs.zencdn.net/8.3.0/video-js.min.css" rel="stylesheet" />
  <script src="https://vjs.zencdn.net/8.3.0/video.min.js"></script>
</head>
<body>
  <header>
    <h1>FREE TV NO BULLSHIT</h1>
  </header>
  <div class="container">
    <div class="channel-list" id="channelList">
      <div id="loading">Loading available channels...</div>
    </div>
    <div class="player-container">
      <video-js id="videoPlayer" class="vjs-default-skin" controls preload="auto" width="100%" height="100%">
        <p class="vjs-no-js">
          To view this video please enable JavaScript, and consider upgrading to a
          web browser that <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
        </p>
      </video-js>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script>
  const channelList = document.getElementById('channelList');
  const loading = document.getElementById('loading');

  let currentChannelIndex = -1;
  let channels = [];
  let player;

  async function fetchAndParseM3U(url) {
    const response = await fetch(url);
    const text = await response.text();
    const lines = text.split('\n');
    const channels = [];
    let currentChannel = {};

    for (let line of lines) {
      line = line.trim();
      if (line.startsWith('#EXTINF:')) {
        const match = line.match(/,(.*)$/);
        if (match) {
          currentChannel = {
            name: match[1]
          };
        }
      } else if (line.startsWith('http')) {
        currentChannel.url = line;
        channels.push(currentChannel);
        currentChannel = {};
      }
    }

    return channels;
  }

  async function checkChannel(url) {
    try {
      const response = await fetch(url, { method: 'HEAD' });
      return response.ok;
    } catch (error) {
      return false;
    }
  }

  async function loadChannels() {
    loading.style.display = 'none';

    for (let i = 0; i < channels.length; i++) {
      const channel = channels[i];
      const isWorking = await checkChannel(channel.url);
      if (isWorking) {
        const channelItem = document.createElement('div');
        channelItem.className = 'channel-item';
        channelItem.innerHTML = `
          <div class="channel-name">${channel.name}</div>
        `;
        channelItem.addEventListener('click', () => {
          selectChannel(i);
        });
        channelList.appendChild(channelItem);
      } else {
        console.log(`Channel ${channel.name} is not working.`);
      }
    }
  }

  function initializeVideoPlayer() {
    player = videojs('videoPlayer', {
      fluid: true,
      aspectRatio: '16:9',
      html5: {
        hls: {
          overrideNative: true,
          enableLowInitialPlaylist: true,
          smoothQualityChange: true,
          handleManifestRedirects: true
        }
      }
    });

    player.on('error', function() {
      console.error('Video player error:', player.error());
    });
  }

  async function initializeChannels() {
    const url = 'https://raw.githubusercontent.com/BuddyChewChew/My-Streams/refs/heads/main/buddy_stream_player.m3u';
    try {
      channels = await fetchAndParseM3U(url);
      loadChannels();
      initializeVideoPlayer();

      if (!isHlsSupported() && !Hls.isSupported()) {
        console.warn('HLS is not supported in this browser. Some channels may not play.');
      }
    } catch (error) {
      console.error('Error initializing channels:', error);
    }
  }

  function selectChannel(index) {
    currentChannelIndex = index;
    const selectedChannel = channels[index];

    if (!player) {
      initializeVideoPlayer();
    }

    player.src({
      type: "application/x-mpegURL",
      src: selectedChannel.url
    });

    player.ready(function() {
      player.play().catch(error => {
        console.error('Error playing video:', error);
      });
    });

    const channelItems = channelList.getElementsByClassName('channel-item');
    for (let i = 0; i < channelItems.length; i++) {
      channelItems[i].classList.remove('active');
    }
    channelItems[index].classList.add('active');

    channelItems[index].scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }

  function isHlsSupported() {
    const video = document.createElement('video');
    return video.canPlayType('application/vnd.apple.mpegurl') !== '';
  }

  initializeChannels();

  channelList.addEventListener('wheel', (e) => {
    e.preventDefault();
    channelList.scrollBy({
      top: e.deltaY,
      behavior: 'smooth'
    });
  });

  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowUp') {
      e.preventDefault();
      if (currentChannelIndex > 0) {
        selectChannel(currentChannelIndex - 1);
      }
    } else if (e.key === 'ArrowDown') {
      e.preventDefault();
      if (currentChannelIndex < channels.length - 1) {
        selectChannel(currentChannelIndex + 1);
      }
    }
  });
</script>

</body></html>